<!DOCTYPE html>
<html>
<head>
	<!--[if tl IE 9]>
	<script 
	src="html5shiv.js">
	</script>
	<![endif]-->
	<title>Deixe aqui seu comentário</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" type="text/css" href="stylesheets/style.css">
</head>

<script>
	var db = openDatabase('Comentarios', '1.0', 'Test DB', 2 * 1024 * 1024);
	
	deletetable();
	createTable();
	
		
	function createTable(){
		db.transaction(
			function(transaction) {         
				transaction.executeSql('CREATE TABLE IF NOT EXISTS Comentario (Numero, ComentarioCirc1, ComentarioCirc2, ComentarioCirc3, ComentarioBRT, ComentarioOutro');
			}
		); 
	}
	

	function insertComentario(){
			db.transaction(
				function(transaction) {

				 	transaction.executeSql('INSERT INTO Comentario (Numero, ComentarioCirc1, ComentarioCirc2, ComentarioCirc3, ComentarioBRT, ComentarioOutro) VALUES ("i","um primeiro comentario", "", "", "", "")');
				}
			); 
		}

	function deleteTable(){
			db.transaction(
				function(transaction) {
					transaction.executeSql('DROP TABLE Comentario');
				}
			);
		}

	function updateTable(){
			db.transaction(
				function(transaction) {
					transaction.executeSql('UPDATE Comentario SET ComentarioCirc1	 = "Alojamento" WHERE Trajeto="TrajetoAloja"');
				}
			);
		}

	
	function checkRadio(){
		if(document.getElementById('circular1').checked) {
			return 1;
		}
		else if(document.getElementById('circular2').checked) {
		  return 2;
		}
		else if(document.getElementById('circular3').checked) {
		  return 3;
		}
		else if(document.getElementById('brt').checked) {
		  return brt;
		}
		else if(document.getElementById('outro').checked) {
		  return outro;
		}
	}

	function submitComentario(check){
		db.transaction(
				function(transaction) {
					console.log("entrei no submit");
					var texto = document.getElementById('campoTexto').value;
					console.log(texto);
					var i = 0;
					if(check == 1){
						transaction.executeSql('INSERT INTO Comentario (Numero, ComentarioCirc1, ComentarioCirc2, ComentarioCirc3, ComentarioBRT, ComentarioOutro) VALUES (i,"", "", "", "", "")');
						console.log("entrei no insert1");
						transaction.executeSql('UPDATE Comentario SET ComentarioCirc1 = texto WHERE Numero=i');
					}
					else if(check == 2){
						transaction.executeSql('INSERT INTO Comentario (Numero, ComentarioCirc1, ComentarioCirc2, ComentarioCirc3, ComentarioBRT, ComentarioOutro) VALUES (i,"", "", "", "", "")');
						transaction.executeSql('UPDATE Comentario SET ComentarioCirc2 = texto WHERE Numero=i');
						console.log("entrei no insert2");
					}
					else if(check == 3){
						transaction.executeSql('INSERT INTO Comentario (Numero, ComentarioCirc1, ComentarioCirc2, ComentarioCirc3, ComentarioBRT, ComentarioOutro) VALUES (i,"", "", "", "", "")');
						transaction.executeSql('UPDATE Comentario SET ComentarioCirc3 = texto WHERE Numero=i');
						console.log("entrei no insert3");
					}
					else if(check == brt){
						transaction.executeSql('INSERT INTO Comentario (Numero, ComentarioCirc1, ComentarioCirc2, ComentarioCirc3, ComentarioBRT, ComentarioOutro) VALUES (i,"", "", "", "", "")');
						transaction.executeSql('UPDATE Comentario SET ComentarioBRT = texto WHERE Numero=i');
						console.log("entrei no insertbrt");
					}
					else if(check == outro){
						transaction.executeSql('INSERT INTO Comentario (Numero, ComentarioCirc1, ComentarioCirc2, ComentarioCirc3, ComentarioBRT, ComentarioOutro) VALUES (i,"", "", "", "", "")');
						transaction.executeSql('UPDATE Comentario SET ComentarioOutro = texto WHERE Numero=i');
						console.log("entrei no insertoutro");
					}
					i = i+1;
				}
			);
	}

</script>

<body>
	<h1 class="header">Deixe aqui seu comentário/reclamação!</h1>
	<br />
	<form method="post" action="comente.html" id="form">
		<p><em>Seu comentário é sobre?</em>
		<input type="radio" name="onibus" id="circular1" value="circular1" /> Circular 1
		<input type="radio" name="onibus" id="circular2" value="circular2" /> Circular 2
		<input type="radio" name="onibus" id="circular3" value="circular3" /> Circular 3
		<input type="radio" name="onibus" id="brt" value="BRT" /> BRT
		<input type="radio" name="onibus" id="outro" value="outro" /> Outro</p>
		<br />
		<textarea rows="4" cols="50" name="comment" id="campoTexto" form="form" placeholder="Deixe seu comentário!" autofocus></textarea><br />

		<input type="button" onclick="submitComentario(checkRadio());" value="Enviar">
	</form>

</body>
</html>
