<!DOCTYPE html>
<html>
<head>
	<!--[if tl IE 9]>
	<script 
	src="html5shiv.js">
	</script>
	<![endif]-->
	<title>Deixe aqui seu comentário</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" type="text/css" href="stylesheets/style.css">
</head>

<script src="jquery-2.1.1.min.js" type="text/javascript"></script>

<script>

	$(document).ready(){
		var request;

		$("#foo").submit(function(event){

	    // Abort any pending request
	    if (request) {
	        request.abort();
	    }
	    // setup some local variables
	    var $form = $(this);

	    // Let's select and cache all the fields
	    var $inputs = $form.find("input, select, button, textarea");

	    // Serialize the data in the form
	    var serializedData = $form.serialize();

	    // Let's disable the inputs for the duration of the Ajax request.
	    // Note: we disable elements AFTER the form data has been serialized.
	    // Disabled form elements will not be serialized.
	    $inputs.prop("disabled", true);

	    // Fire off the request to /form.php
	    request = $.ajax({
	        url: "/form.php",
	        type: "post",
	        data: serializedData
	    });

	    // Callback handler that will be called on success
	    request.done(function (response, textStatus, jqXHR){
	        // Log a message to the console
	        console.log("Hooray, it worked!");
	    });

	    // Callback handler that will be called on failure
	    request.fail(function (jqXHR, textStatus, errorThrown){
	        // Log the error to the console
	        console.error(
	            "The following error occurred: "+
	            textStatus, errorThrown
	        );
	    });

	    // Callback handler that will be called regardless
	    // if the request failed or succeeded
	    request.always(function () {
	        // Reenable the inputs
	        $inputs.prop("disabled", false);
	    });

	    // Prevent default posting of form
	    event.preventDefault();
		});
}



	var db = openDatabase('Comentarios', '1.0', 'Coisa', 2 * 1024 * 1024);
	
	$banco = db;
	//deleteTable();
	createTable();
	
	

	function createTable(){
		db.transaction(
			function(transaction) {         
				transaction.executeSql('CREATE TABLE IF NOT EXISTS Comentario (Numero UNIQUE NOT NULL, ComentarioCirc1, ComentarioCirc2, ComentarioCirc3, ComentarioBRT, ComentarioOutro, PRIMARY KEY (Numero))');
			}
		); 
	}
	

	function insertComentario(){
			db.transaction(
				function(transaction) {

				 	transaction.executeSql('INSERT INTO Comentario (Numero, ComentarioCirc1, ComentarioCirc2, ComentarioCirc3, ComentarioBRT, ComentarioOutro) VALUES ("numero","teste1", "teste2", "teste3", "testebrt", "testeoutro")');
				}
			); 
		}

	function deleteTable(){
			db.transaction(
				function(transaction) {
					transaction.executeSql('DROP TABLE Comentario');
					//transaction.executeSql('DROP Comentarios');
				}
			);
		}

	function updateTable(){
			db.transaction(
				function(transaction) {
					transaction.executeSql('UPDATE Comentario SET ComentarioCirc1	 = "Alojamento" WHERE Trajeto="TrajetoAloja"');
				}
			);
		}

	
	function checkRadio(){
		if(document.getElementById('circular1').checked) {
			return 1;
		}
		else if(document.getElementById('circular2').checked) {
		  return 2;
		}
		else if(document.getElementById('circular3').checked) {
		  return 3;
		}
		else if(document.getElementById('brt').checked) {
		  return brt;
		}
		else if(document.getElementById('outro').checked) {
		  return outro;
		}
	}
	
	var i = 0;
	function submitComentario(check){
		db.transaction(
				function(transaction) {
					console.log("entrei no submit");
					var texto = document.getElementById('campoTexto').value;
					console.log(texto);
					
					if(check == 1){
						transaction.executeSql('INSERT INTO Comentario (Numero, ComentarioCirc1, ComentarioCirc2, ComentarioCirc3, ComentarioBRT, ComentarioOutro) VALUES (i,texto, "", "", "", "")');
						console.log("entrei no insert1");
					}
					else if(check == 2){
						transaction.executeSql('INSERT INTO Comentario (Numero, ComentarioCirc1, ComentarioCirc2, ComentarioCirc3, ComentarioBRT, ComentarioOutro) VALUES (i,"", texto "", "", "")');
						console.log("entrei no insert2");
					}
					else if(check == 3){
						transaction.executeSql('INSERT INTO Comentario (Numero, ComentarioCirc1, ComentarioCirc2, ComentarioCirc3, ComentarioBRT, ComentarioOutro) VALUES (i,"", "", texto, "", "")');
						console.log("entrei no insert3");
					}
					else if(check == brt){
						transaction.executeSql('INSERT INTO Comentario (Numero, ComentarioCirc1, ComentarioCirc2, ComentarioCirc3, ComentarioBRT, ComentarioOutro) VALUES (i,"", "", "", texto, "")');
						console.log("entrei no insertbrt");
					}
					else if(check == outro){
						transaction.executeSql('INSERT INTO Comentario (Numero, ComentarioCirc1, ComentarioCirc2, ComentarioCirc3, ComentarioBRT, ComentarioOutro) VALUES (i,"", "", "", "", texto)');
						console.log("entrei no insertoutro");
					}
					i = i+1;
					console.log(i);
				}
			);
	}

</script>

<body>
	<h1 class="header">Deixe aqui seu comentário/reclamação!</h1>
	<br />
	<form method="post" action="comente.html" >
		<p><em>Seu comentário é sobre?</em>
		<input type="radio" name="onibus" id="circular1" value="circular1" /> Circular 1
		<input type="radio" name="onibus" id="circular2" value="circular2" /> Circular 2
		<input type="radio" name="onibus" id="circular3" value="circular3" /> Circular 3
		<input type="radio" name="onibus" id="brt" value="BRT" /> BRT
		<input type="radio" name="onibus" id="outro" value="outro" /> Outro</p>
	</form>
	<form method="post" action="comente.html" id="foo">
		<label for="campoTexto">Ensira seu comentário</label>
  		<input id="campoTexto" name="campoTexto" type="text" value="" />

		<input type="submit" value="Enviar">
	</form>

	<br>
	<br>
	<li><a href="home.html">Home</a></li>
	
</body>
</html>
